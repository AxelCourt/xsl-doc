<?xml version="1.0" encoding="UTF-8"?>
<!--
This Source Code Form is subject to the terms of 
the Mozilla Public License, v. 2.0. If a copy of 
the MPL was not distributed with this file, You 
can obtain one at https://mozilla.org/MPL/2.0/.
-->
<config xmlns="http://efl.fr/chaine/saxon-pipe/config"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://efl.fr/chaine/saxon-pipe/config gaulois-pipe:/fr/efl/chaine/xslt/schemas/gaulois-pipe_config.xsd">
    <pipe mutiThreadMaxSourceSize="24349456" nbThreads="1">
        <xslt href="cp:/get-xfile-dependencies.xsl">
            <param name="includeContent" value="false"/>
        </xslt>
        <xslt href="cp:/getFileContent.xsl"/>
        <xslt href="cp:/calculateRelativePaths.xsl">
            <param name="absoluteRootFolder" value="$[absoluteRootFolder]"/>
        </xslt>
        <tee>
            <pipe1>
                <xslt href="cp:/prepareTOC.xsl"></xslt>
                <xslt href="cp:/makeTOC.xsl">
                    <param name="outputFolder" value="$[outputFolder]"/>
                </xslt>
                <output id="toc" indent="yes" method="xhtml">
                    <folder relative="target/generated-test-files" to="${user.dir}"/>
                    <fileName name="${basename}-toc.html"/>
                </output>
            </pipe1>
            <pipe2>
                <xslt href="cp:/calculateHtmlOutputFile.xsl">
                    <param name="outputFolder" value="$[outputFolder]"/>
                </xslt>
                <tee>
                    <pipe1>
                        <xslt href="cp:/makeDoc.xsl"/>
                        <output id="terminaison">
                            <null/>
                        </output>
                    </pipe1>
                    <pipe2>
                        <xslt href="cp:/makeIndex.xsl"/>
                        <output indent="yes" method="xml" id="index-terminaison">
                            <!--folder relative="target/generated-test-files" to="${user.dir}"/>
                            <fileName name="${basename}-content.xml"/-->
                            <null/>
                        </output>
                    </pipe2>
                </tee>
            </pipe2>
        </tee>
    </pipe>
    <params>
        <param name="outputFolder" value="should give it to command line"/>
        <param name="absoluteRootFolder" value="should give it to command line"/>
    </params>
    <sources>
        <!--folder href="./src/test/run" pattern=".*\.xsl" recurse="true"/-->
        <file href="./src/test/run/etat-DeveloppementDepense.xsl"/>
    </sources>
</config>
